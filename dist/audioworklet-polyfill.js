!function(){var e=256;"function"!=typeof AudioWorkletNode&&(window.AudioWorkletNode=function(t,n){var i=r(t)[n];if(this.parameters=new Map,i.properties)for(var s=0;s<i.properties.length;s++){var c=i.properties[s],a=t.createGain().gain;a.value=c.defaultValue,this.parameters.set(c.name,a)}var u=new i.Processor({});this.port=i.port;var p=t.createScriptProcessor(e);p.node=this,p.processor=i,p.instance=u,p.onaudioprocess=o,Object.defineProperty(this,"$$node",{value:p})},Object.defineProperties(window.AudioWorkletNode.prototype=Object.create(AudioNode.prototype),{bufferSize:{get:function(){return this.$$node.bufferSize}},connect:{value:function(e){return this.$$node.connect(e)}},disconnect:{value:function(){return this.$$node.disconnect()}}}),Object.defineProperty(AudioContext.prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new window.AudioWorklet(this))}}),window.AudioWorklet=function(){function e(e){this.$$context=e}return e.prototype.addModule=function(e,t){var o=this;return fetch(e).then(function(e){if(!e.ok)throw Error(e.status);return e.text()}).then(function(e){var n=new MessageChannel,i={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){},registerProcessor:function(e,t){r(o.$$context)[e]={port:n.port1,context:i,Processor:t,properties:t.parameterDescriptors||[]}},postMessage:function(e){n.port2.postMessage(e)},addEventListener:function(e,t){n.port2.addEventListener(e,t)},removeEventListener:function(e,t){n.port2.addEventListener(e,t)}};return Object.defineProperty(i,"onmessage",{get:function(){return n.port2.onmessage},set:function(e){n.port2.onmessage=e}}),i.self=i,new function(e,t){var o=document.createElement("iframe");o.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",t.appendChild(o);var n=o.contentWindow,r=n.document,i="var window,$hook";for(var s in n)s in e||"eval"===s||(i+=",",i+=s);for(var c in e)i+=",",i+=c,i+="=self.",i+=c;var a=r.createElement("script");a.appendChild(r.createTextNode('function $hook(self,console) {"use strict";\n        '+i+";return function() {return eval(arguments[0])}}")),r.body.appendChild(a),this.exec=n.$hook(e,console)}(i,document.documentElement).exec((t&&t.transpile||String)(e)),null})},e}());var t=[];function o(o){var r={},i=-1;this.node.parameters.forEach(function(o,n){var s=t[++i]||(t[i]=new Float32Array(e));s.fill(o.value),r[n]=s}),this.processor.context.sampleRate=this.context.sampleRate,this.processor.context.currentTime=this.context.currentTime;var s=n(o.inputBuffer),c=n(o.outputBuffer);this.instance.process([s],[c],r)}function n(e){for(var t=[],o=0;o<e.numberOfChannels;o++)t[o]=e.getChannelData(o);return t}function r(e){return e.$$processors||(e.$$processors={})}}();
//# sourceMappingURL=audioworklet-polyfill.js.map
